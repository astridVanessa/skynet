<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Cambiar Contrase침a</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light">

  <div class="container mt-5">
    <div class="card shadow-lg mx-auto" style="max-width: 500px;">
      <div class="card-body">
        <h4 class="text-center text-primary">游 Cambiar Contrase침a</h4>

        <form id="cambioForm">
          <div class="mb-3">
            <label>Usuario</label>
            <input type="text" id="NombreUsuario" class="form-control" required>
          </div>
          <div class="mb-3">
            <label>Contrase침a actual</label>
            <input type="password" id="Contrase침aActual" class="form-control" required>
          </div>
          <div class="mb-3">
            <label>Nueva contrase침a</label>
            <input type="password" id="NuevaContrase침a" class="form-control" required>
          </div>
          <button class="btn btn-primary w-100">Actualizar</button>
        </form>

        <div id="mensaje" class="text-center mt-3 fw-bold"></div>
      </div>
    </div>
  </div>

<script>
  document.getElementById("cambioForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const mensaje = document.getElementById("mensaje");
    const data = {
      NombreUsuario: document.getElementById("NombreUsuario").value,
      Contrase침aActual: document.getElementById("Contrase침aActual").value,
      NuevaContrase침a: document.getElementById("NuevaContrase침a").value,
    };

    try {
      const res = await fetch("/api/cambiar-contrasena", {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data),
      });

      const result = await res.json();

      if (result.ok) {
        mensaje.textContent = result.message;
        mensaje.className = "text-success text-center fw-bold";
      } else {
        mensaje.textContent = result.error;
        mensaje.className = "text-danger text-center fw-bold";
      }
    } catch (err) {
      mensaje.textContent = "Error de conexi칩n con el servidor";
      mensaje.className = "text-danger text-center fw-bold";
    }
     localStorage.clear(); // Limpia datos guardados del usuario
      window.location.href = "login.html"; // Redirige al login
  });
</script>

</body>
</html>
